/*
 *	tiny-bs-grid https://github.com/jeffhehe/tiny-bs-grid
 *  this works for TinyMCE5.* on Bootstrap 3.*
 *  Version: v0.4 mod 0.01 OnlineCreation (fr translation)
 *  Author: Jeff Wang + OnlineCreation
 *  Date: Jan 20, 2023 + Feb 24, 2023
 */
!function(){tinymce.PluginManager.add("bootstrap3grid",function(e,t){e.contentCSS.push(t+"/bootstrapgrid-style.css"),e.ui.registry.addToggleButton("bootstrap3grid",{text:"Colonnes",tooltip:"Système de grille",onAction:function(){var t="Insérer une grille",n=["12"],l="md",s=e.selection.getNode(),o=jQuery(s).parents("div.row"),a=o.length>0;if(a){var r=o[0],p=jQuery(r).children("div"),d=p.length,u=[];if(d>0)for(n=[],i=0;i<d;i++){var c=jQuery(p[i]).attr("class").split(/\s+/),v=jQuery(p[i]).html();for(u.push(v),j=0;j<c.length;j++)if(/^col-.*/i.test(c[j])){0==j&&(c[0].indexOf("col-lg")>-1?l="lg":c[0].indexOf("col-sm")>-1?l="sm":c[0].indexOf("col-xs")>-1&&(l="xs"));var g=c[j].lastIndexOf("-"),x=c[j].substr(g+1);n.push(x)}}t="Modifier/supprimer la grille"}var m=[{type:"selectbox",name:"grid",label:"Grid",items:[{text:"1 Colonne",value:"12"},{text:"2 Colonnes (½:½)",value:"6,6"},{text:"2 Colonnes (⅔:⅓)",value:"8,4"},{text:"2 Colonnes (¾:¼)",value:"9,3"},{text:"2 Colonnes (⅓:⅔)",value:"4,8"},{text:"2 Colonnes (¾:¼)",value:"3,9"},{text:"3 Colonnes (⅓:⅓:⅓)",value:"4,4,4"},{text:"3 Colonnes (½:¼:¼)",value:"6,3,3"},{text:"3 Colonnes (¼:½:¼)",value:"3,6,3"},{text:"3 Colonnes (¼:¼:½)",value:"3,3,6"},{text:"4 Colonnes (¼:¼:¼:¼)",value:"3,3,3,3"}]}],f={type:"panel",items:m};a&&(f={type:"tabpanel",tabs:[{title:"Modifier la grille",items:m},{title:"Paramètres avancés",items:[{type:"selectbox",name:"size",label:"(Avancé) Point de rupture",items:[{text:"Grand écran (>= 1200px)",value:"lg"},{text:"Écran de petit ordinateur (>= 992px)",value:"md"},{text:"Tablette (>= 768px)",value:"sm"},{text:"Téléphone (< 768px)",value:"xs"}]},{type:"checkbox",name:"leadingBreak",label:"Ajouter un saut de ligne"+(a?"(recommandé)":"")}]},{title:"Supprimer la grille",items:[{type:"checkbox",name:"removeGrids",label:"Supprimer la grille"}]}]});e.windowManager.open({title:t,body:f,initialData:{size:l,grid:n.toString(),leadingBreak:!a},buttons:[{type:"submit",name:"submitBtn",text:a?"Modifier":"Insérer"},{type:"cancel",name:"cancelBtn",text:"Annuler"}],onSubmit:function(t){var i=t.getData(),n="",l="",s="<p>&nbsp;</p>";if(1==i.leadingBreak&&(n="<p>&nbsp;</p>"),1==i.removeGrids&&a)return l=u.join("<p>&nbsp;</p>"),jQuery(o).replaceWith(n+l+s),void t.close();!function(e){const t=e.length;if(a){if(d>0&&d<t){for(var n=0;n<d;n++)l+='<div class="col-'+i.size+"-"+e[n]+'">'+u.shift()+"</div>";for(var o=d;o<t;o++)l+='<div class="col-'+i.size+"-"+e[o]+'"><p>&nbsp;</p></div>'}else if(d>=t){for(var n=0;n<t;n++)l+='<div class="col-'+i.size+"-"+e[n]+'">'+u.shift()+"</div>";d>t&&(s="<p>&nbsp;</p><div>"+u.join("<p>&nbsp;</p>")+"</div><p>&nbsp;</p>")}}else for(var r=0;r<t;r++)l+='<div class="col-'+i.size+"-"+e[r]+'"><p>&nbsp;</p></div>'}(i.grid.split(",")),a?jQuery(o).replaceWith(n+'<div class="row">'+l+"</div>"+s):e.insertContent(n+'<div class="row">'+l+"</div>"+s),t.close()}})},onSetup:function(t){e.selection.selectorChanged("div.row",function(e){t.setActive(e)})}})})}();